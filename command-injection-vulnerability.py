import requests

def readFile(fileName):
  """Reads a file and returns a list of read lines
  Parameters:
  fileName (string) -- the name of the file (path and format included)
  """
  lines = []
  try:
    with open(fileName, 'r') as f:
      for line in f:
        lines.append(line.replace('\n', ''))
  except:
    raise Exception('File', urlsFile, 'doesn\'t exists')
  return lines

def getRequest(url, queryParams):
  if url:
    return requests.get(url, params=queryParams)
  return ''


host = input('Insert the host (default http://localhost): ')
if not host:
  host = 'http://localhost'
else:
  while not host.startswith("http://"):
    #controlla anche che non sia vuoto dopo //
    host = input('Host not valid.\nInsert a valid host (ex. http://localhost): ')

urlsFile = input('Insert the URLs file name (default urls.txt): ')
if not urlsFile:
  urlsFile = 'urls.txt'
payloadsFile = input('Insert the payloads file name (default payloads.txt): ')
if not payloadsFile:
  payloadsFile = 'payloads.txt'

urls = readFile(urlsFile)
payloads = readFile(payloadsFile)

# Expected url format: /some/random/url/with-page.php:param1,param2,param3
for url in urls:
  splitted = url.split(':')
  if len(splitted) > 1:
    baseUrl = splitted[0].replace(':', ' ')
    params = splitted[1]
    paramsList = params.split(',')
    if len(paramsList) == 1:
      for payload in payloads:
        queryParams = {}
        queryParams[paramsList[0]] = payload
        result = getRequest(host + baseUrl, queryParams)
        if result.ok:
          print('result:', result.text)
    else:
      print('len > 1')
